# Fantasy Manager
Автоматизированный инструмент для управления аккаунтами Fantasy на Monad.

## Contacts
* Telegram Channel: [unluck_1l0ck](https://t.me/unluck_1l0ck)
* Telegram: @one_lock
* Twitter/X: [@1l0ck](https://x.com/1l0ck)

## Описание
Данный скрипт автоматизирует процессы авторизации и выполнения ежедневных заданий для множества аккаунтов Fantasy. Основные функции:
- Авторизация через приватный ключ
- Получение ежедневных наград (daily claim)
- Выполнение квеста "onboarding" для новых аккаунтов
- Автоматическая регистрация в турнирах (Bronze, Silver, Gold, Elite)

## Настройка
1. Создайте папки `data` и `logs`, если они не существуют.
2. Добавьте ваши приватные ключи и адреса в файл `data/keys_and_addresses.txt` в формате:
   ```
   privateKey:walletAddress
   ```
3. Добавьте прокси в файл `data/proxys.txt` (по одному на строку)
4. Настройте файл `data/config.json` согласно вашим требованиям

## Конфигурация
Основные параметры в `config.json`:
```json
{
    "app": {
        "threads": 10,              // Количество потоков
        "keys_file": "data/keys_and_addresses.txt",
        "proxy_file": "data/proxys.txt",
    },
    "capmonster": {
        "enabled": true,            // Включить capmonster для решения капчи
        "api_key": "your-api-key"   // Ваш API ключ Capmonster
    },
    "daily": {
        "enabled": true             // Включить получение ежедневных наград
    },
    "onboarding_quest": {
        "enabled": false,           // Если true, выполнит onboarding квест
        "id": "69e67d0a-0a08-4085-889f-58df15bdecb8"
    },
    "tournaments": {
        "enabled": true,            // Включить автоматическую регистрацию в турнирах
        "types": {
            "bronze": {
                "enabled": true,    // Включить регистрацию в бронзовом турнире
                "id": "a5a63d39-756f-4d6e-9796-0d9fc46b8d1f", // ID текущего турнира
                "max_stars": 18     // Максимальное количество звезд для турнира
            },
            "silver": {
                "enabled": true,
                "id": "",          // Укажите ID серебряного турнира
                "max_stars": 23
            },
            "gold": {
                "enabled": false,
                "id": "",          // Укажите ID золотого турнира
                "max_stars": 25
            },
            "elite": {
                "enabled": false,
                "id": "",          // Укажите ID элитного турнира
                "max_stars": 999
            }
        }
    }
}
```

## Использование
Запустите скрипт командой:
```
python run.py
```
При запуске вы можете указать задержку перед началом в секундах.

## Отладка
В файле `utils.py` можно изменить значение `DEBUG_MODE = True` для получения подробных логов. По умолчанию режим отладки отключен для минимизации вывода.

## Функции
### Авторизация
Скрипт автоматически авторизуется через Privy используя SIWE (Sign-In With Ethereum). Для каждого аккаунта сохраняется токен и куки для повторного использования.

### Daily Claim
После успешной авторизации скрипт получает ежедневную награду. Если включено, эта функция будет вызываться для каждого аккаунта автоматически. В логах отображается:
- Текущая серия (streak)
- День в серии
- Тип и размер полученной награды

### Onboarding Quest
Если в `config.json` включена опция `onboarding_quest`, скрипт выполнит квест Onboarding для новых аккаунтов. Данный квест выполняется один раз для каждого аккаунта.

### Регистрация в турнирах
Модуль регистрации в турнирах позволяет автоматически участвовать в различных турнирах Fantasy Top. Функциональность включает:

- Автоматическое получение списка доступных карт на аккаунте
- Умный выбор оптимальных комбинаций 5 карт для каждого типа турнира
- Учет ограничений по звездам: Bronze (18), Silver (23), Gold (25), Elite (без ограничений)
- Алгоритм выбора наиболее ценных карт с учетом рейтинга и звезд
- Приоритезация распределения карт от элитных к бронзовым турнирам

Для использования регистрации в турнирах:
1. Включите опцию `tournaments.enabled` в config.json
2. Для каждого типа турнира, в котором хотите участвовать:
   - Установите `enabled` в `true`
   - Укажите актуальный ID турнира в поле `id`
   - ID турнира можно найти в URL на странице турнира или через отладчик сети браузера

**Важно**: ID турниров меняются для каждого нового турнира. Обязательно обновляйте ID в конфигурации перед запуском.

## Логи
Все операции логируются в терминале и в файле `logs/app.log`:
- SUCCESS: успешные операции (зеленый цвет)
- ERROR: ошибки (красный цвет) 
- INFO: информационные сообщения
- RATE LIMIT: ограничения по частоте запросов (желтый цвет)

Успешные аккаунты сохраняются в `logs/success_accounts.txt`.
Неудачные попытки записываются в `logs/failure_accounts.txt` для последующего повторения.
